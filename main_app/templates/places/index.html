{% extends 'base.html' %}

{% block content %}
    <h1 class="font-bold font-header text-h4 dp:text-h1 ml-8 m-4">Places near you</h1>
    <!-- added category filter -->
    <form id="categoryFilterForm" method="GET">
        <select name="selected_category" id="categorySelect" class="border rounded px-4 ml-8 py-1 bg-secondary border-none pr-8>
            <option value="" class="">Select a Category</option>
            {% for category in categories %}
                <option value="{{ category }}">{{ category }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="">Filter</button>
    </form>
    <!-- end -->
    <div class="grid grid-cols-1 m-8 gap-4">
        {% for place in places %}
            <a href="{% url 'place_details' place.id %}">
                <div class="w-full bg-primary text-light rounded-lg shadow-md p-4 cursor-pointer">
                    <h3 class="text-h5 dp:text-h4 font-header font-bold">{{ place.name }}</h3>
                    <p class="text-body font-body dp:text-body-lg dp:font-bold">{{ place.category}}</p>
                    <p class="hidden font-body dp:block">{{ place.address }}</p>
                    <p class="font-body">Average Rating: {{ place.avg_rating|floatformat:1 }}</p>
                </div>
            </a>
        {% endfor %}
    </div>
    
{% endblock %}

{% block javascript %}
    <script>
        const categorySelect = document.getElementById('categorySelect');
        categorySelect.addEventListener('change', () => {
            document.getElementById('categoryFilterForm').submit();
        });
    </script>
{% endblock %}